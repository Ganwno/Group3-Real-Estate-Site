<%
#   Created: Daniel Swain
#   Date: 20/04/2016
#
#   Partial erb used by any page.
#   This represents the modal used to either sign up or log in
#
#   Todo:
#   	* Form field validation
#   	* Connect to the actual user signup and login actions
#   	* Change forgotten password link to point to correct action. Currently points to buy_path
%>

<% # The status modal %>
<div class="ui user-login-signup modal" id="user-login-signup-modal">
	<% # Modal header %>
	<div class="header">
		Welcome to Propertydome
	</div>

	<% # Modal content %>
	<div class="content">
		<div class="ui centered middle aligned grid">
			<% # Choose either login or sign up %>
			<div class="row">
				<div class="ui buttons">
					<button class="ui button" id="user-login-button">Login</button>
					<button class="ui button" id="user-sign-up-button">Sign Up</button>
				</div>
			</div>

			<% # The facebook button. This is a placeholder and will be replaced with code from Facebook soon %>
			<div class="row margin-top-half">
				<button class="ui social-user-button facebook-button button">
					<%= image_tag "f-logo.png", class: "icon" %>
					<span class="user-action"></span> with Facebook
				</button>
			</div>
			<% # The Google button. This is a placeholder and will be replaced with code from Google soon %>
			<div class="row">
				<button class="ui social-user-button google-button button">
					<%= image_tag "g-logo.png", class: "icon" %>
					<span class="user-action"></span> with Google
				</button>
			</div>
			<% # An or, just like Jaydens design %>
			<div class="row margin-top-half">
				or
			</div>
			<% # The username/email and password form fields %>
			<div class="row margin-top-half">
				
				<div id="user-sign-up-form">
					<% # error class required to show devise_error_messages (they only show if they exist) %>
					<%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "ui form error" }) do |f| %>
						<% # User sign up email field %>
						<div class="field">
							<div class="ui left icon input">
								<i class="inverted mail icon"></i>
								<%= f.email_field :email, autofocus: true, placeholder: "Enter your email" %>
							</div>
						</div>
						
						<% # User sign up password field %>
						<div class="field">
							<div class="ui left icon input">
								<i class="inverted unlock alternative icon"></i>
								<% if @minimum_password_length %>
									<em>(<%= @minimum_password_length %> characters minimum)</em>
								<% end %>
								<%= f.password_field :password, autocomplete: "off", placeholder: "Enter your password" %>
							</div>
						</div>
						
						<% # User sign up confirm password %>
						<div class="field">
							<div class="ui left icon input">
								<i class="inverted unlock alternative icon"></i>
								<%= f.password_field :password_confirmation, autocomplete: "off", placeholder: "Confirm your password" %>
							</div>
						</div>
						
						<% # Devise error messages (only show if they exist) %>
						<%= devise_error_messages! %>

						<div class="actions margin-top">
							<%= f.submit "Sign up", class: "ui active-choice social-user-button button" %>
						</div>
					<% end %>
				</div>
				
				<% # User login form (from devise/sessions/new.html.erb) %>
				<div id="user-login-form">
					<%= form_for(resource, as: resource_name, url: session_path(resource_name), html: { class: "ui form error" }) do |f| %>
						<% # Email field %>
						<div class="field">
							<div class="ui left icon input">
								<i class="inverted mail icon"></i>
								<%= f.email_field :email, autofocus: true, placeholder: "Enter your email" %>
							</div>
						</div>

						<% # Password Field %>
						<div class="field">
							<div class="ui left icon input">
								<i class="inverted unlock alternative icon"></i>
								<%= f.password_field :password, autocomplete: "off", placeholder: "Enter your password" %>
							</div>
						</div>
						
						<% # Remember me box, if devise lets you be remembered %>
						<% if devise_mapping.rememberable? -%>
							<div class="inline field">
								<div class="ui checkbox">
									<%= f.check_box :remember_me %>
									<%= f.label :remember_me %>
								</div>
							</div>
						<% end -%>
						
						<% # Devise error messages (only show if they exist) %>
						<%= devise_error_messages! %>
						
						<% # Forgot password link (from devise/shared/links) %>	
						<%= link_to "Forgot your password?", new_password_path(resource_name) %>

						<% # Log in action %>
						<div class="actions margin-top">
							<%= f.submit "Log in", class: "ui active-choice social-user-button button" %>
						</div>
					<% end %>
				</div>
			</div>
		</div>
	</div>
<!-- 
	<% # The action buttons %>
	<div class="actions">
		<div class="ui centered one column grid">
			<div class="ui eight wide column">
				<% # The action for this are set in user_login.coffee in the onDeny and onApprove callbacks for the modal %>
				<div class="ui fluid approve active-choice button"><span class="user-action"></span></div>
			</div>
		</div>
	</div> -->
</div>
